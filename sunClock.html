<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Sun Clock</title>
    <link rel="stylesheet" type="text/css" href="https://rawgit.com/maxint137/sunClock/master/css3clock.css" />
    <link href="sunrise.css" rel="stylesheet">
    <style>
        .outer_face .marker,
        .outer_face::before,
        .outer_face::after,
        .inner_face {
            background: transparent;
        }
        
        .outer_face .marker,
        input#lightswitch:checked~.main .square .outer_face::before,
        input#lightswitch:checked~.main .square .outer_face::after,
        input#lightswitch:checked~.main .square .outer_face,
        input#lightswitch:checked~.main .square .inner_face {
            background-color: transparent;
        }
    </style>
</head>

<body>
    <input type="checkbox" id="lightswitch" />
    <div class="main">
        <div class="square">

            <div id="liveclock" class="outer_face bgNight">

                <div class="marker oneseven bgNight"></div>
                <div class="marker twoeight"></div>
                <div class="marker fourten"></div>
                <div class="marker fiveeleven"></div>

                <a href="https://rawgit.com/maxint137/sunClock/master/sunClock.html">
                    <div class="inner_face" data-after="山吹町">
                        <div class="hand hour"></div>
                        <div class="hand minute"></div>
                        <div class="hand second"></div>
                </a>
                </div>
            </div>
        </div>
    </div>

    <div id="sun"></div>
    <div id="sunDay"></div>
    <div id="sunSet"></div>
    <div id="sky"></div>

    <div id="horizon"></div>

    <div id="horizonNight"></div>

    <div id="moon"></div>
    <div id="water"></div>

    <div id="waterReflectionContainer">
        <div id="waterReflectionMiddle"></div>
    </div>

    <div id="waterDistance"></div>
    <div id="darknessOverlaySky"></div>
    <div id="darknessOverlay"></div>
    <div id="oceanRipple"></div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://rawgit.com/mourner/suncalc/master/suncalc.js"></script>

    <script type="text/javascript" language="JavaScript" src="sunrise.js"></script>
    <script type="text/javascript">
        var sr = new Sunrise(document, 0.75);

        function windowResize() {
            sr.updateDimensions();
        }

        var latlng = {
            lat: 35.7075239,
            lng: 139.729803
        }

        var $hands = $('#liveclock div.hand')

        window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || function(f) {
            setTimeout(f, 60)
        }


        function updateclock(timestamp, firstCall) {

            var curdate = new Date();


            var hour_as_degree = (curdate.getHours() + curdate.getMinutes() / 60) / 12 * 360
            var minute_as_degree = (curdate.getMinutes() + curdate.getSeconds() / 60) / 60 * 360
            var second_as_degree = (curdate.getSeconds() + curdate.getMilliseconds() / 1000) / 60 * 360

            $hands.filter('.hour').css({
                transform: 'rotate(' + hour_as_degree + 'deg)'
            })
            $hands.filter('.minute').css({
                transform: 'rotate(' + minute_as_degree + 'deg)'
            })
            $hands.filter('.second').css({
                transform: 'rotate(' + second_as_degree + 'deg)'
            })

            if (firstCall || 0 == curdate.getSeconds() % 5) {
                var times = SunCalc.getTimes(new Date(), latlng.lat, latlng.lng);
                var lightsOn = times.sunrise < new Date() && new Date() < times.sunset;
                $("#lightswitch").prop("checked", !lightsOn);

                // update the barckground too:
                sr.setCurrentTime(curdate);
            }

            // refresh the sunrise data once a night
            if (0 == curdate.getHours() && 7 == curdate.getMinutes() && 5 == curdate.getSeconds()) {
                sr = new Sunrise(document, 0.75);
                console.log(sr.times);
            }

            requestAnimationFrame(updateclock)
        }

        updateclock(7, true);

        requestAnimationFrame(updateclock)

        function initMap() {
            navigator.geolocation.getCurrentPosition(function(location) {
                latlng.lat = location.coords.latitude;
                latlng.lng = location.coords.longitude;
                console.log(latlng);

                geodecode(latlng);
            });

        }

        function geodecode(latlng) {
            var geocoder = new google.maps.Geocoder;

            var locationNames = [];
            geocoder.geocode({
                'location': latlng
            }, function(results, status) {
                if (status === 'OK') {
                    results.forEach(function(result) {
                        // find sublocality or locality in types of address_components
                        result.address_components.forEach(function(ac) {
                            if (-1 < ac.types.indexOf('locality')) {
                                locationNames.push(ac.short_name);
                            }

                        }, this);
                    }, this);

                } else {
                    window.alert('Geocoder failed due to: ' + status);
                }

                console.log(locationNames);
                $('.inner_face').attr('data-after', locationNames[0]);

            });
        }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBuGXhTSdPtnyhV3GNq20bu9V_Qu1e5Fjc&callback=initMap">
    </script>
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-91481619-1', 'auto');
        ga('send', 'pageview');
    </script>
    <script type="text/javascript">
        reformal_wdg_domain = "sunClock";
        reformal_wdg_mode = 0;
        reformal_wdg_title = "SunClock";
        reformal_wdg_ltitle = "Feedback";
        reformal_wdg_lfont = "";
        reformal_wdg_lsize = "";
        reformal_wdg_color = "#33006e";
        reformal_wdg_bcolor = "#516683";
        reformal_wdg_tcolor = "#FFFFFF";
        reformal_wdg_align = "right";
        reformal_wdg_waction = 0;
        reformal_wdg_vcolor = "#9FCE54";
        reformal_wdg_cmline = "#E0E0E0";
        reformal_wdg_glcolor = "#105895";
        reformal_wdg_tbcolor = "#FFFFFF";

        reformal_wdg_bimage = "bea4c2c8eb82d05891ddd71584881b56.png";
    </script>

    <script type="text/javascript" language="JavaScript" src="http://idea.informer.com/tab6.js?domain=sunClock"></script><noscript><a href="http://sunClock.idea.informer.com">SunClock feedback </a> <a href="http://idea.informer.com"><img src="http://widget.idea.informer.com/tmpl/images/widget_logo.jpg" /></a></noscript>
    <script>
        $('.furrghtd').css('z-index', '555').css('opacity', '0.5');
        $('.furrghtd td').css('padding-bottom', '30px').css('vertical-align', 'bottom');
    </script>

</body>

</html>